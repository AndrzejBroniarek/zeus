{% extends 'server_ui/templates/base.html' %}
{% block title %}{{ settings.SITE_TITLE }}{% endblock %}
{% load i18n  pagination_tags %}

{% block header %}
<h2>{{ settings.SITE_TITLE }}</h2>
{% endblock %}

{% block tabs_menu %}
{% with menu_active="list" %}
{% include "_admin_index_menu.html" %}
{% endwith %}
{% endblock %}


{% block content %}
{% if password_changed %}
<div class="alert success panel">
    {% trans "Your new password was set." %}
</div>
{% endif %}
{% autopaginate elections_administered %}
{% paginate %}
<table class="elections">
  <thead>
    <th>
        {% trans "Name" %}
    </th>
    <th>
        {% trans "Institution" %}
    </th>
    <th>
        {% trans "Administrator" %}
    </th>
    <th>
        {% trans "Creation" %} 
    </th>
    <th>
        {% trans "Start" %} 
    </th>
    <th>
        {% trans "End" %}
    </th>
    {% if not user.superadmin_p %}
    <th>
      {% trans "Election status" %}
    </th>
    <th>
      {% trans "Trial" %}
    </th>
    {% endif %}
  </thead>
  <tbody>
    {% for election in elections_administered %}
    <tr>
      <td>  
          {% if election.result %}
          <b style="color:green">[ΕΧΕΙ ΟΛΟΚΛΗΡΩΘΕΙ]</b><br />
          {% endif %}
          {% if election.canceled_at %}
          <b style="color:red">[ΕΧΕΙ ΑΚΥΡΩΘΕΙ]</b><br />
          {% endif %}
          {% if election.is_completed %}
          <b style="color:orange">[ΔΗΜΟΣΙΑ ΠΡΟΒΟΛΗ]</b><br />
          {% endif %}
          {% if user.superadmin_p %}
            <a href="{% url helios.views.election_report election.uuid "html" %}">
              {{ election.name }}
            </a>
            {% if election.result %}
            <br />
            <a class="button small" 
              href="{% url helios.views.one_election_set_completed election.uuid %}">
              {% if not election.is_completed %}ΔΗΜΟΣΙΑ ΠΡΟΒΟΛΗ{% else %}ΑΚΥΡΩΣΗ ΔΗΜΟΣΙΑΣ ΠΡΟΒΟΛΗΣ{% endif %}
            </a>
            {% endif %}
            {% else %}
            <a href="{% url election_index election.uuid %}">
              {{ election.name }}
            </a>
            {% endif %}
        </td>
        <td>
          {{ election.institution.name }}
        </td>
        <td>
            {{ election.admins.all.0.info.name }}
        </td>
        <td>
          {{ election.created_at }}
        </td>
        <td>
            {{ election.voting_starts_at }}
        </td>
        <td>
            {% if election.voting_extended_until %}
                {{ election.voting_extended_until }}
            {% else %}
                {{ election.voting_ends_at }}
            {% endif %}
        </td>
        <td class="{% if election.feature_canceled %}alert{% endif %}">
          {{ election.status_display }}
        </td>
        <td>
          {% if election.trial %}
            {% trans "YES" %}
          {% else %}
            {% trans "NO" %}
          {% endif %}
        </td>
    </tr>
    {% endfor %}
  </tbody>
    </table>
{% paginate %}
{% endblock %}

